!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("chart.js"),require("chart.js/helpers")):"function"==typeof define&&define.amd?define(["exports","chart.js","chart.js/helpers"],r):r((e="undefined"!=typeof globalThis?globalThis:e||self).ChartErrorBars={},e.Chart,e.Chart.helpers)}(this,(function(e,r,t){"use strict";const a=["xMin","xMax","yMin","yMax"];function n(e){return e?a.slice(0,2):a.slice(2)}function s(e,r,t,a,n){const s=[`${a.axis}Min`,`${a.axis}Max`],o=a.getBasePixel();for(const i of s){const s=r[i];Array.isArray(s)?e[i]=s.map((e=>n?o:a.getPixelForValue(e,t))):e[i]="number"==typeof s?n?o:a.getPixelForValue(s,t):null}}const o=["linear","logarithmic","time","timeseries"];function i(e){return o.includes(e.type)}const l={errorBarLineWidth:{v:[1,3]},errorBarColor:{v:["#2c2c2c","#1f1f1f"]},errorBarWhiskerLineWidth:{v:[1,3]},errorBarWhiskerRatio:{v:[.2,.25]},errorBarWhiskerSize:{v:[20,24]},errorBarWhiskerColor:{v:["#2c2c2c","#1f1f1f"]}},c={_scriptable:!0,_indexable:e=>"v"!==e},u=Object.keys(l);function d(e,r){const t=Array.isArray(e)?e:[e],a=Array.isArray(r)?r:[r];if(t.length===a.length)return t.map(((e,r)=>[e,a[r]]));const n=Math.max(t.length,a.length);return Array(n).map(((e,r)=>[t[r%t.length],a[r%a.length]]))}function h(e,r){if("string"==typeof e||"number"==typeof e)return e;const t=Array.isArray(e)?e:e.v;return t[r%t.length]}function p(e,r,t){const a=h(r.errorBarWhiskerRatio,t);if(null!=e&&a>0)return e*a*.5;return.5*h(r.errorBarWhiskerSize,t)}function f(e,r){var t,a,n,s;const o=e.getProps(["x","y","width","height","xMin","xMax","yMin","yMax"]);null==o.xMin&&null==o.xMax||function(e,r,t,a,n){n.save(),n.translate(0,e.y);const s=d(null==r?e.x:r,null==t?e.x:t);s.reverse().forEach((([r,t],o)=>{const i=s.length-o-1,l=p(e.height,a,i);n.lineWidth=h(a.errorBarLineWidth,i),n.strokeStyle=h(a.errorBarColor,i),n.beginPath(),n.moveTo(r,0),n.lineTo(t,0),n.stroke(),n.lineWidth=h(a.errorBarWhiskerLineWidth,i),n.strokeStyle=h(a.errorBarWhiskerColor,i),n.beginPath(),n.moveTo(r,-l),n.lineTo(r,l),n.moveTo(t,-l),n.lineTo(t,l),n.stroke()})),n.restore()}(o,null!==(t=o.xMin)&&void 0!==t?t:null,null!==(a=o.xMax)&&void 0!==a?a:null,e.options,r),null==o.yMin&&null==o.yMax||function(e,r,t,a,n){n.save(),n.translate(e.x,0);const s=d(null==r?e.y:r,null==t?e.y:t);s.reverse().forEach((([r,t],o)=>{const i=s.length-o-1,l=p(e.width,a,i);n.lineWidth=h(a.errorBarLineWidth,i),n.strokeStyle=h(a.errorBarColor,i),n.beginPath(),n.moveTo(0,r),n.lineTo(0,t),n.stroke(),n.lineWidth=h(a.errorBarWhiskerLineWidth,i),n.strokeStyle=h(a.errorBarWhiskerColor,i),n.beginPath(),n.moveTo(-l,r),n.lineTo(l,r),n.moveTo(-l,t),n.lineTo(l,t),n.stroke()})),n.restore()}(o,null!==(n=o.yMin)&&void 0!==n?n:null,null!==(s=o.yMax)&&void 0!==s?s:null,e.options,r)}function m(e,r){const t=e.getProps(["x","y","startAngle","endAngle","rMin","rMax","outerRadius"]);null==t.rMin&&null==t.rMax||function(e,r,t,a,n){n.save(),n.translate(e.x,e.y);const s=(e.startAngle+e.endAngle)/2,o=Math.cos(s),i=Math.sin(s),l={x:-i,y:o},c=Math.sqrt(l.x*l.x+l.y*l.y);l.x/=c,l.y/=c;const u=d(null!=r?r:e.outerRadius,null!=t?t:e.outerRadius);u.reverse().forEach((([e,r],t)=>{const s=u.length-t-1,c=e*o,d=e*i,f=r*o,m=r*i,x=p(null,a,s),y=l.x*x,g=l.y*x;n.lineWidth=h(a.errorBarLineWidth,s),n.strokeStyle=h(a.errorBarColor,s),n.beginPath(),n.moveTo(c,d),n.lineTo(f,m),n.stroke(),n.lineWidth=h(a.errorBarWhiskerLineWidth,s),n.strokeStyle=h(a.errorBarWhiskerColor,s),n.beginPath(),n.moveTo(c+y,d+g),n.lineTo(c-y,d-g),n.moveTo(f+y,m+g),n.lineTo(f-y,m-g),n.stroke()})),n.restore()}(t,t.rMin,t.rMax,e.options,r)}class x extends r.BarElement{draw(e){super.draw(e),f(this,e)}}x.id="barWithErrorBar",x.defaults={...r.BarElement.defaults,...l},x.defaultRoutes=r.BarElement.defaultRoutes,x.descriptors=c;class y extends r.PointElement{draw(e,r){super.draw.call(this,e,r),f(this,e)}}y.id="pointWithErrorBar",y.defaults={...r.PointElement.defaults,...l},y.defaultRoutes=r.PointElement.defaultRoutes,y.descriptors=c;class g extends r.ArcElement{draw(e){super.draw(e),m(this,e)}}function E(e){return Array.isArray(e)?e.slice().reverse():e}function M(e){const t=n(e.element.horizontal),a=r.Tooltip.defaults.callbacks.label.call(this,e),s=e.chart.data.datasets[e.datasetIndex].data[e.dataIndex];return null==s||t.every((e=>null==s[e]))?a:`${a} (${E(s[t[0]])} .. ${s[t[1]]})`}g.id="arcWithErrorBar",g.defaults={...r.ArcElement.defaults,...l},g.defaultRoutes=r.ArcElement.defaultRoutes,g.descriptors=c;const b={color(e,r,a){const n=e||"transparent",s=r||"transparent";if(n===s)return r;const o=t.color(n),i=o.valid&&t.color(s);return i&&i.valid?i.mix(o,a).hexString():r},number:(e,r,t)=>e===r?r:e+(r-e)*t};function v(e,r,t,a,n){if(typeof e===a&&typeof r===a)return n(e,r,t);if(Array.isArray(e)&&Array.isArray(r))return e.map(((e,a)=>n(e,r[a],t)));const s=e=>e&&Array.isArray(e.v);return s(e)&&s(r)?{v:e.v.map(((e,a)=>n(e,r.v[a],t)))}:r}const B={animations:{numberArray:{fn:function(e,r,t){return v(e,r,t,"number",b.number)},properties:a.concat(u.filter((e=>!e.endsWith("Color"))),["rMin","rMax"])},colorArray:{fn:function(e,r,t){return v(e,r,t,"string",b.color)},properties:u.filter((e=>e.endsWith("Color")))}}};function C(e,r){const{axis:t}=e;e.axis=`${t}MinMin`;const{min:a}=r(e);e.axis=`${t}MaxMax`;const{max:n}=r(e);return e.axis=t,{min:a,max:n}}function W(e,r,t){return Array.isArray(r)?t(e,...r):"number"==typeof r?t(e,r):e}function S(e,r,t,a,n){const s="string"==typeof r?r:r.axis,o=`${s}Min`,i=`${s}Max`,l=`${s}MinMin`,c=`${s}MaxMax`;for(let r=0;r<n;r+=1){const n=r+a,u=e[r];u[o]="object"==typeof t[n]?t[n][o]:null,u[i]="object"==typeof t[n]?t[n][i]:null,u[l]=W(u[s],u[o],Math.min),u[c]=W(u[s],u[i],Math.max)}}function A(e,r,t,a){const{axis:n}=r,s=r.getLabels();for(let o=0;o<a;o+=1){const a=o+t;e[o][n]=r.parse(s[a],a)}}function P(e,t,a,n=[],s=[]){r.registry.addControllers(a),Array.isArray(n)?r.registry.addElements(...n):r.registry.addElements(n),Array.isArray(s)?r.registry.addScales(...s):r.registry.addScales(s);const o=t;return o.type=e,o}class D extends r.BarController{getMinMax(e,r){return C(e,(e=>super.getMinMax(e,r)))}parsePrimitiveData(e,r,t,a){const n=super.parsePrimitiveData(e,r,t,a);return this.parseErrorData(n,e,r,t,a),n}parseObjectData(e,r,t,a){const n=super.parseObjectData(e,r,t,a);return this.parseErrorData(n,e,r,t,a),n}parseErrorData(e,r,t,a,n){S(e,r.vScale,t,a,n);i(r.iScale)?S(e,r.iScale,t,a,n):A(e,r.iScale,a,n)}updateElement(e,r,t,a){"number"==typeof r&&s(t,this.getParsed(r),r,this._cachedMeta.vScale,"reset"===a),super.updateElement(e,r,t,a)}}D.id="barWithErrorBars",D.defaults=t.merge({},[r.BarController.defaults,B,{dataElementType:x.id}]),D.overrides=t.merge({},[r.BarController.overrides,{plugins:{tooltip:{callbacks:{label:M}}}}]),D.defaultRoutes=r.BarController.defaultRoutes;class k extends r.Chart{constructor(e,t){super(e,P("barWithErrorBars",t,D,x,[r.LinearScale,r.CategoryScale]))}}k.id=D.id;class T extends r.LineController{getMinMax(e,r){return C(e,(e=>super.getMinMax(e,r)))}parsePrimitiveData(e,r,t,a){const n=super.parsePrimitiveData(e,r,t,a);return this.parseErrorData(n,e,r,t,a),n}parseObjectData(e,r,t,a){const n=super.parseObjectData(e,r,t,a);return this.parseErrorData(n,e,r,t,a),n}parseErrorData(e,r,t,a,n){S(e,r.vScale,t,a,n);i(r.iScale)?S(e,r.iScale,t,a,n):A(e,r.iScale,a,n)}updateElement(e,r,t,a){e instanceof y&&"number"==typeof r&&this.updateElementScale(r,t,a),super.updateElement(e,r,t,a)}updateElementScale(e,r,t){s(r,this.getParsed(e),e,this._cachedMeta.vScale,"reset"===t);i(this._cachedMeta.iScale)&&s(r,this.getParsed(e),e,this._cachedMeta.iScale,"reset"===t)}updateElements(e,r,t,a){const n="reset"===a,s=this.chart._animationsDisabled||n||"none"===a;if(super.updateElements(e,r,t,a),s)for(let n=r;n<r+t;++n){const r=e[n];r instanceof y&&this.updateElementScale(n,r,a)}}}T.id="lineWithErrorBars",T.defaults=t.merge({},[r.LineController.defaults,B,{dataElementType:y.id}]),T.overrides=t.merge({},[r.LineController.overrides,{plugins:{tooltip:{callbacks:{label:M}}}}]),T.defaultRoutes=r.LineController.defaultRoutes;class $ extends r.Chart{constructor(e,t){super(e,P("lineWithErrorBars",t,T,y,[r.LinearScale,r.CategoryScale]))}}$.id=T.id;class L extends r.ScatterController{getMinMax(e,r){return C(e,(e=>super.getMinMax(e,r)))}parsePrimitiveData(e,r,t,a){const n=super.parsePrimitiveData(e,r,t,a);return this.parseErrorData(n,e,r,t,a),n}parseObjectData(e,r,t,a){const n=super.parseObjectData(e,r,t,a);return this.parseErrorData(n,e,r,t,a),n}parseErrorData(e,r,t,a,n){S(e,r.xScale,t,a,n),S(e,r.yScale,t,a,n)}updateElement(e,r,t,a){e instanceof y&&"number"==typeof r&&this.updateElementScale(r,t,a),super.updateElement(e,r,t,a)}updateElementScale(e,r,t){s(r,this.getParsed(e),e,this._cachedMeta.xScale,"reset"===t),s(r,this.getParsed(e),e,this._cachedMeta.yScale,"reset"===t)}updateElements(e,r,t,a){const n="reset"===a,s=this.chart._animationsDisabled||n||"none"===a;if(super.updateElements(e,r,t,a),s)for(let n=r;n<r+t;++n){const r=e[n];r instanceof y&&this.updateElementScale(n,r,a)}}}L.id="scatterWithErrorBars",L.defaults=t.merge({},[r.ScatterController.defaults,B,{dataElementType:y.id}]),L.overrides=t.merge({},[r.ScatterController.overrides,{plugins:{tooltip:{callbacks:{label:function(e){const r=e.chart.data.datasets[e.datasetIndex].data[e.dataIndex],t=(e,t)=>{const a=n(t);return null==r||a.every((e=>null==r[e]))?e:`${e} [${E(r[a[0]])} .. ${r[a[1]]}]`};return`(${t(e.label,!0)}, ${t(e.parsed.y,!1)})`}}}}}]),L.defaultRoutes=r.LineController.defaultRoutes;class R extends r.Chart{constructor(e,t){super(e,P("scatterWithErrorBars",t,L,y,[r.LinearScale]))}}R.id=L.id;class I extends r.PolarAreaController{getMinMaxImpl(e){const r=this._cachedMeta,t={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return r.data.forEach(((r,a)=>{const n=this.getParsed(a)[e.axis];!Number.isNaN(n)&&this.chart.getDataVisibility(a)&&(n<t.min&&(t.min=n),n>t.max&&(t.max=n))})),t}getMinMax(e){return C(e,(e=>this.getMinMaxImpl(e)))}countVisibleElements(){const e=this._cachedMeta;return e.data.reduce(((r,t,a)=>!Number.isNaN(e._parsed[a].r)&&this.chart.getDataVisibility(a)?r+1:r),0)}parsePrimitiveData(e,r,t,a){const n=super.parsePrimitiveData(e,r,t,a);return this.parseErrorData(n,e,r,t,a),n}parseObjectData(e,r,t,a){const n=super.parseObjectData(e,r,t,a);return this.parseErrorData(n,e,r,t,a),n}parseErrorData(e,r,t,a,n){const s=r.rScale;for(let r=0;r<n;r+=1){const n=r+a,o=t[n],i=s.parse(o[s.axis],n);e[r]={[s.axis]:i}}S(e,s,t,a,n)}updateElement(e,r,t,a){"number"==typeof r&&function(e,r,t,a,n){const s=n.animation,o=[`${t.axis}Min`,`${t.axis}Max`],i=e=>{const r=t.getDistanceFromCenterForValue(e),n=s.animateScale?0:r;return a?n:r};for(const t of o){const a=r[t];Array.isArray(a)?e[t]=a.map(i):e[t]="number"==typeof a?i(a):null}}(t,this.getParsed(r),this._cachedMeta.rScale,"reset"===a,this.chart.options),super.updateElement(e,r,t,a)}updateElements(e,r,t,a){const n=this.chart.scales.r,s=n.getDistanceFromCenterForValue;n.getDistanceFromCenterForValue=function(e){return"number"==typeof e?s.call(this,e):s.call(this,e.r)},super.updateElements(e,r,t,a),n.getDistanceFromCenterForValue=s}}I.id="polarAreaWithErrorBars",I.defaults=t.merge({},[r.PolarAreaController.defaults,B,{dataElementType:g.id}]),I.overrides=t.merge({},[r.PolarAreaController.overrides,{plugins:{tooltip:{callbacks:{label:function(e){const t=r.PolarAreaController.overrides.plugins.tooltip.callbacks.label.call(this,e),a=e.chart.data.datasets[e.datasetIndex].data[e.dataIndex],n=["rMin","rMax"];return null==a||n.every((e=>null==a[e]))?t:`${t} [${E(a[n[0]])} .. ${a[n[1]]}]`}}}}}]),I.defaultRoutes=r.PolarAreaController.defaultRoutes;class j extends r.Chart{constructor(e,t){super(e,P("polarAreaWithErrorBars",t,I,g,[r.RadialLinearScale]))}}j.id=I.id,r.registry.addControllers(D,T,I,L),r.registry.addElements(x,g,y),e.ArcWithErrorBar=g,e.BarWithErrorBar=x,e.BarWithErrorBarsChart=k,e.BarWithErrorBarsController=D,e.LineWithErrorBarsChart=$,e.LineWithErrorBarsController=T,e.PointWithErrorBar=y,e.PolarAreaWithErrorBarsChart=j,e.PolarAreaWithErrorBarsController=I,e.ScatterWithErrorBarsChart=R,e.ScatterWithErrorBarsController=L}));
//# sourceMappingURL=index.umd.min.js.map
